<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Run Canek on a toy example</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Run Canek on a toy example</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Canek)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Functions</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Function to plot the pca coordinates</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>plotPCA <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">pcaData =</span> <span class="cn">NULL</span>, <span class="at">label =</span> <span class="cn">NULL</span>, <span class="at">legPosition =</span> <span class="st">&quot;topleft&quot;</span>){</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  col <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(label) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> pcaData[,<span class="st">&quot;PC1&quot;</span>], <span class="at">y =</span> pcaData[,<span class="st">&quot;PC2&quot;</span>],</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">as.integer</span>(label), <span class="at">cex =</span> <span class="fl">0.75</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PC2&quot;</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(legPosition,  <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">levels</span>(label), </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span>  <span class="fu">unique</span>(<span class="fu">as.integer</span>(label)))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="load-the-data" class="section level2">
<h2>Load the data</h2>
<p>On this toy example we use the two simulated batches included in the <code>SimBatches</code> data from Canekâ€™s package. <code>SimBatches</code> is a list containing:</p>
<ul>
<li><code>batches</code>: Simulated scRNA-seq datasets with genes (rows) and cells (columns). Simulations were performed using <a href="https://bioconductor.org/packages/devel/bioc/vignettes/splatter/inst/doc/splatter.html">Splatter</a>.</li>
<li><code>cell_type</code>: a factor containing the celltype labels of the batches</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>lsData <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">B1 =</span> SimBatches<span class="sc">$</span>batches[[<span class="dv">1</span>]], <span class="at">B2 =</span> SimBatches<span class="sc">$</span>batches[[<span class="dv">2</span>]])</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>batch <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Batch-1&quot;</span>, <span class="fu">ncol</span>(lsData[[<span class="dv">1</span>]])),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="st">&quot;Batch-2&quot;</span>, <span class="fu">ncol</span>(lsData[[<span class="dv">2</span>]]))))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>celltype <span class="ot">&lt;-</span> SimBatches<span class="sc">$</span>cell_types</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(batch)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; batch</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Batch-1 Batch-2 </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     631     948</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(celltype)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; celltype</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cell Type 1 Cell Type 2 Cell Type 3 Cell Type 4 </span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        1451          53          38          37</span></span></code></pre></div>
</div>
<div id="pca-before-correction" class="section level2">
<h2>PCA before correction</h2>
<p>We perform the Principal Component Analysis (PCA) of the joined datasets and scatter plot the first two PCs. The batch-effect causes cells to group by batch.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(cbind, lsData)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>pcaData <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">t</span>(data), <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>x</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotPCA</span>(<span class="at">pcaData =</span> pcaData, <span class="at">label =</span> batch, <span class="at">legPosition =</span> <span class="st">&quot;bottomleft&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotPCA</span>(<span class="at">pcaData =</span> pcaData, <span class="at">label =</span> celltype, <span class="at">legPosition =</span> <span class="st">&quot;bottomleft&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="run-canek" class="section level2">
<h2>Run Canek</h2>
<p>We correct the toy batches using the function <em>RunCanek</em>. This function accepts:</p>
<ul>
<li>List of matrices</li>
<li>Seurat object</li>
<li>List of Seurat objects</li>
<li>SingleCellExperiment object</li>
<li>List of SingleCellExperiment objects</li>
</ul>
<p>On this example we use the list of matrices created before.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">RunCanek</span>(lsData)</span></code></pre></div>
</div>
<div id="pca-after-correction" class="section level2">
<h2>PCA after correction</h2>
<p>We perform PCA of the corrected datasets and plot the first two PCs. After correction, the cells group by their corresponding cell type.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pcaData <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">t</span>(data), <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>x</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotPCA</span>(<span class="at">pcaData =</span> pcaData, <span class="at">label =</span> batch, <span class="at">legPosition =</span> <span class="st">&quot;topleft&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotPCA</span>(<span class="at">pcaData =</span> pcaData, <span class="at">label =</span> celltype, <span class="at">legPosition =</span> <span class="st">&quot;topleft&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="session-info" class="section level2">
<h2>Session info</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R version 4.1.2 (2021-11-01)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64 (64-bit)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running under: Windows 10 x64 (build 19044)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Matrix products: default</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; locale:</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] LC_COLLATE=C                   LC_CTYPE=English_World.1252   </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3] LC_MONETARY=English_World.1252 LC_NUMERIC=C                  </span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5] LC_TIME=English_World.1252    </span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; system code page: 932</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attached base packages:</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; other attached packages:</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] Canek_0.2.0</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] Rcpp_1.0.8           highr_0.9            DEoptimR_1.0-10     </span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4] bslib_0.3.1          compiler_4.1.2       bluster_1.4.0       </span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7] jquerylib_0.1.4      class_7.3-19         prabclus_2.3-2      </span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10] BiocNeighbors_1.12.0 numbers_0.8-2        tools_4.1.2         </span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13] mclust_5.4.9         digest_0.6.29        jsonlite_1.8.0      </span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16] evaluate_0.15        lattice_0.20-45      pkgconfig_2.0.3     </span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19] rlang_1.0.1          Matrix_1.4-0         igraph_1.2.11       </span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [22] cli_3.1.1            rstudioapi_0.13      yaml_2.3.5          </span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [25] parallel_4.1.2       xfun_0.29            fastmap_1.1.0       </span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [28] stringr_1.4.0        knitr_1.37           cluster_2.1.2       </span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [31] sass_0.4.0           S4Vectors_0.32.3     fpc_2.2-9           </span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [34] diptest_0.76-0       nnet_7.3-16          stats4_4.1.2        </span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [37] grid_4.1.2           robustbase_0.93-9    R6_2.5.1            </span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [40] flexmix_2.3-17       BiocParallel_1.28.3  rmarkdown_2.12      </span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [43] irlba_2.3.5          kernlab_0.9-29       magrittr_2.0.2      </span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [46] matrixStats_0.61.0   modeltools_0.2-23    MASS_7.3-54         </span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [49] htmltools_0.5.2      BiocGenerics_0.40.0  stringi_1.7.6       </span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [52] FNN_1.1.3</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
